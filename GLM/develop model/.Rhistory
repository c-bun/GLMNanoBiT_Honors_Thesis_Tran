data_RA <- read_csv("Data_AkrongAndMcGahan.csv")
library(ggplot2)
library(dplyr)
library(readr)
library(tidyverse)
library(broom)
data_RA <- read_csv("Data_AkrongAndMcGahan.csv")
View(data_RA)
library(ggplot2)
library(dplyr)
library(readr)
library(tidyverse)
library(broom)
a <- read_csv("/Users/suongsuong/Documents/GitHub/GLMNanoBiT/GLM/develop model/N8_counted.csv")
colnames(data_RAAM_raw)['B1_1'] <- "B1"
data_RAAM_raw <- read_csv("Data_AkrongAndMcGahan.csv")
colnames(data_RAAM_raw)['B1_1'] <- "B1"
colnames(data_RAAM_raw)['B2_1'] <- "B2"
colnames(data_RAAM_raw)['B1_2'] <- "B1"
colnames(data_RAAM_raw)['B2_2'] <- "B2"
RAAM_raw_1 = data_RAAM_raw %>% select(c(1,2,3,6,7,8))
RAAM_raw_2 = data_RAAM_raw %>% select(c(1,4,5,6,7,8))
data_RAAM = rbind(RAAM_raw_1,RAAM_raw_2)
colnames(data_RAAM_raw)['B1_1'] <- "B1"
colnames(data_RAAM_raw)['B2_1'] <- "B2"
colnames(data_RAAM_raw)['B1_2'] <- "B1"
colnames(data_RAAM_raw)['B2_2'] <- "B2"
RAAM_raw_1 = data_RAAM_raw %>% select(c(1,2,3,6,7,8))
RAAM_raw_2 = data_RAAM_raw %>% select(c(1,4,5,6,7,8))
data_RAAM = rbind(RAAM_raw_1, RAAM_raw_2)
colnames(data_RAAM_raw)[2] <- "B1"
colnames(data_RAAM_raw)[3] <- "B2"
colnames(data_RAAM_raw)[4] <- "B1"
colnames(data_RAAM_raw)[5] <- "B2"
RAAM_raw_1 = data_RAAM_raw %>% select(c(1,2,3,6,7,8))
RAAM_raw_2 = data_RAAM_raw %>% select(c(1,4,5,6,7,8))
data_RAAM = rbind(RAAM_raw_1, RAAM_raw_2)
View(data_RAAM)
data_RAAM_raw <- read_csv("Data_AkrongAndMcGahan.csv")
colnames(data_RAAM_raw)[2] <- "B1"
colnames(data_RAAM_raw)[3] <- "B2"
colnames(data_RAAM_raw)[4] <- "B1"
colnames(data_RAAM_raw)[5] <- "B2"
RAAM_1 <- data_RAAM_raw %>%
select(c(1, 2, 3, 6, 7, 8)) %>%
filter(library != 0, B1 != 0 | B2 != 0) %>%
mutate_all(~ ifelse(. == 0, 0.1, .))
View(RAAM_1)
data_RAAM_raw <- read_csv("Data_AkrongAndMcGahan.csv")
colnames(data_RAAM_raw)[2] <- "B1"
colnames(data_RAAM_raw)[3] <- "B2"
colnames(data_RAAM_raw)[4] <- "B1"
colnames(data_RAAM_raw)[5] <- "B2"
RAAM_raw_1 <- data_RAAM_raw %>% select(c(1,2,3,6,7,8))
RAAM_1 <-filter(RAAM_raw_1[1:nrow(RAAM_raw_1),],library!=0) #remove one has library = 0
RAAM_1 <- filter(RAAM_1, B1 != 0 | B2 != 0) #remove one has b1=0 and b2=0
RAAM_1[RAAM_1==0] <- 0.1
data_RAAM_raw <- read_csv("Data_AkrongAndMcGahan.csv")
colnames(data_RAAM_raw)[2] <- "B1"
colnames(data_RAAM_raw)[3] <- "B2"
colnames(data_RAAM_raw)[4] <- "B1"
colnames(data_RAAM_raw)[5] <- "B2"
RAAM_1 <- data_RAAM_raw %>%
select(c(1, 2, 3, 6, 7, 8)) %>%
filter(library != 0, B1 != 0 | B2 != 0) %>%
mutate_all(~ ifelse(. == 0, 0.1, .))
#dMut = (Mut B1/ WT B1) / (Mut lib / WT lib)
RAAM_1$B1dMut <- (RAAM_1$B1/ RAAM_1$B1[1])  / (RAAM_1$library/ RAAM_1$library[1])
RAAM_1$B2dMut <- (RAAM_1$B2/ RAAM_1$B2[1])  / (RAAM_1$library/ RAAM_1$library[1])
RAAM_1$changeB2_B1 <- RAAM_1$B2dMut - RAAM_1$B1dMut
#RAAM_raw_2 = data_RAAM_raw %>% select(c(1,4,5,6,7,8))
#data_RAAM = rbind(RAAM_raw_1, RAAM_raw_2)
View(RAAM_1)
View(data_RAAM_raw)
data_RAAM_raw <- read_csv("Data_AkrongAndMcGahan.csv")
colnames(data_RAAM_raw)[2] <- "B1"
colnames(data_RAAM_raw)[3] <- "B2"
colnames(data_RAAM_raw)[4] <- "B1"
colnames(data_RAAM_raw)[5] <- "B2"
RAAM_raw_1 = data_RAAM_raw %>% select(c(1,2,3,6,7,8))
RAAM_raw_2 = data_RAAM_raw %>% select(c(1,4,5,6,7,8))
data_RAAM = rbind(RAAM_raw_1, RAAM_raw_2)
View(data_RAAM)
data_RAAM_raw <- read_csv("Data_AkrongAndMcGahan.csv")
colnames(data_RAAM_raw)[2] <- "B1"
colnames(data_RAAM_raw)[3] <- "B2"
colnames(data_RAAM_raw)[4] <- "B1"
colnames(data_RAAM_raw)[5] <- "B2"
RAAM_raw_1 <- data_RAAM_raw %>% select(c(1,2,3,6,7,8))
RAAM_raw_2 <- data_RAAM_raw %>% select(c(1,4,5,6,7,8))
data_RAAM <- rbind(RAAM_raw_1, RAAM_raw_2)
data_RAAM <- data_RAAM %>%
filter(library != 0, B1 != 0 | B2 != 0) %>%
mutate_all(~ ifelse(. == 0, 0.1, .))
data_RAAM_raw <- read_csv("Data_AkrongAndMcGahan.csv")
colnames(data_RAAM_raw)[2] <- "B1"
colnames(data_RAAM_raw)[3] <- "B2"
colnames(data_RAAM_raw)[4] <- "B1"
colnames(data_RAAM_raw)[5] <- "B2"
RAAM_raw_1 <- data_RAAM_raw %>% select(c(1,2,3,6,7,8))
RAAM_raw_2 <- data_RAAM_raw %>% select(c(1,4,5,6,7,8))
data_RAAM <- rbind(RAAM_raw_1, RAAM_raw_2) %>%
filter(library != 0, B1 != 0 | B2 != 0) %>%
mutate_all(~ ifelse(. == 0, 0.1, .))
View(data_RAAM_raw)
data_RAAM_raw <- read_csv("Data_AkrongAndMcGahan.csv")
colnames(data_RAAM_raw)[2] <- "B1"
colnames(data_RAAM_raw)[3] <- "B2"
colnames(data_RAAM_raw)[4] <- "B1"
colnames(data_RAAM_raw)[5] <- "B2"
RAAM_raw_1 <- data_RAAM_raw %>% select(c(1,2,3,6,7,8))
RAAM_raw_2 <- data_RAAM_raw %>% select(c(1,4,5,6,7,8))
data_RAAM <- rbind(RAAM_raw_1, RAAM_raw_2) %>%
filter(library != 0, B1 != 0 | B2 != 0) %>%  #remove one has library=0 or (b1=0 and b2=0)
mutate_all(~ ifelse(. == 0, 0.1, .)) #value = 0 -> 0.1
#GENERALIZE
#formula: dMut = (Mut B1/ WT B1) / (Mut lib / WT lib)
data_RAAM$B1dMut <- (data_RAAM$B1/ data_RAAM$B1[1])  / (data_RAAM$library/ data_RAAM$library[1])
data_RAAM$B2dMut <- (data_RAAM$B2/ data_RAAM$B2[1])  / (data_RAAM$library/ data_RAAM$library[1])
data_RAAM$changeB2_B1 <- data_RAAM$B2dMut - data_RAAM$B1dMut
data_RAAM<- arrange(data_RAAM, pos)
data_RAAM$pos <- as.character(df$pos)
data_RAAM<- arrange(data_RAAM, pos)
data_RAAM$pos <- as.character(data_RAAM$pos)
data_RAAM_raw <- read_csv("Data_AkrongAndMcGahan.csv")
colnames(data_RAAM_raw)[2] <- "B1"
colnames(data_RAAM_raw)[3] <- "B2"
colnames(data_RAAM_raw)[4] <- "B1"
colnames(data_RAAM_raw)[5] <- "B2"
RAAM_raw_1 <- data_RAAM_raw %>% select(c(1,2,3,6,7,8))
RAAM_raw_2 <- data_RAAM_raw %>% select(c(1,4,5,6,7,8))
data_RAAM <- rbind(RAAM_raw_1, RAAM_raw_2) %>%
filter(library != 0, B1 != 0 | B2 != 0) %>%  #remove one has library=0 or (b1=0 and b2=0)
mutate_all(~ ifelse(. == 0, 0.1, .)) #value = 0 -> 0.1
#GENERALIZE
#formula: dMut = (Mut B1/ WT B1) / (Mut lib / WT lib)
data_RAAM$B1dMut <- (data_RAAM$B1/ data_RAAM$B1[1])  / (data_RAAM$library/ data_RAAM$library[1])
data_RAAM$B2dMut <- (data_RAAM$B2/ data_RAAM$B2[1])  / (data_RAAM$library/ data_RAAM$library[1])
data_RAAM$changeB2_B1 <- data_RAAM$B2dMut - data_RAAM$B1dMut
data_RAAM<- arrange(data_RAAM, pos)
data_RAAM$pos <- as.character(data_RAAM$pos)
gauss_model <- glm( changeB2_B1 ~ pos * mut , data = data_RAAM, family = 'gaussian')
#options(max.print=10000)    #set limit to print the output
summary(gauss_model)
View(RAAM_1)
data_RAAM_raw <- read_csv("Data_AkrongAndMcGahan.csv")
colnames(data_RAAM_raw)[2] <- "B1"
colnames(data_RAAM_raw)[3] <- "B2"
colnames(data_RAAM_raw)[4] <- "B1"
colnames(data_RAAM_raw)[5] <- "B2"
#have to split for generlization later (corresponed WT)
RAAM_1 <- data_RAAM_raw %>%
select(c(1, 2, 3, 6, 7, 8)) %>%
filter(library != 0, B1 != 0 | B2 != 0) %>%
mutate_all(~ ifelse(. == 0, 0.1, .))
#GENERALIZE
#formula: dMut = (Mut B1/ WT B1) / (Mut lib / WT lib)
RAAM_1$B1dMut <- (RAAM_1$B1/ RAAM_1$B1[1])  / (RAAM_1$library/ RAAM_1$library[1])
RAAM_1$B2dMut <- (RAAM_1$B2/ RAAM_1$B2[1])  / (RAAM_1$library/ RAAM_1$library[1])
RAAM_1$changeB2_B1 <- RAAM_1$B2dMut - RAAM_1$B1dMut
RAAM_2 <- data_RAAM_raw %>%
select(c(1, 4, 5, 6, 7, 8)) %>%
filter(library != 0, B1 != 0 | B2 != 0) %>%
mutate_all(~ ifelse(. == 0, 0.1, .))
#GENERALIZE
#formula: dMut = (Mut B1/ WT B1) / (Mut lib / WT lib)
RAAM_2$B1dMut <- (RAAM_2$B1/ RAAM_2$B1[1])  / (RAAM_2$library/ RAAM_2$library[1])
RAAM_2$B2dMut <- (RAAM_2$B2/ RAAM_2$B2[1])  / (RAAM_2$library/ RAAM_2$library[1])
RAAM_2$changeB2_B1 <- RAAM_2$B2dMut - RAAM_2$B1dMut
data_RAAM = rbind(RAAM_raw_1, RAAM_raw_2)
data_RAAM_raw <- read_csv("Data_AkrongAndMcGahan.csv")
colnames(data_RAAM_raw)[2] <- "B1"
colnames(data_RAAM_raw)[3] <- "B2"
colnames(data_RAAM_raw)[4] <- "B1"
colnames(data_RAAM_raw)[5] <- "B2"
#have to split for generlization later (corresponed WT)
RAAM_1 <- data_RAAM_raw %>%
select(c(1, 2, 3, 6, 7, 8)) %>%
filter(library != 0, B1 != 0 | B2 != 0) %>%
mutate_all(~ ifelse(. == 0, 0.1, .))
#GENERALIZE
#formula: dMut = (Mut B1/ WT B1) / (Mut lib / WT lib)
RAAM_1$B1dMut <- (RAAM_1$B1/ RAAM_1$B1[1])  / (RAAM_1$library/ RAAM_1$library[1])
RAAM_1$B2dMut <- (RAAM_1$B2/ RAAM_1$B2[1])  / (RAAM_1$library/ RAAM_1$library[1])
RAAM_1$changeB2_B1 <- RAAM_1$B2dMut - RAAM_1$B1dMut
RAAM_2 <- data_RAAM_raw %>%
select(c(1, 4, 5, 6, 7, 8)) %>%
filter(library != 0, B1 != 0 | B2 != 0) %>%
mutate_all(~ ifelse(. == 0, 0.1, .))
#GENERALIZE
#formula: dMut = (Mut B1/ WT B1) / (Mut lib / WT lib)
RAAM_2$B1dMut <- (RAAM_2$B1/ RAAM_2$B1[1])  / (RAAM_2$library/ RAAM_2$library[1])
RAAM_2$B2dMut <- (RAAM_2$B2/ RAAM_2$B2[1])  / (RAAM_2$library/ RAAM_2$library[1])
RAAM_2$changeB2_B1 <- RAAM_2$B2dMut - RAAM_2$B1dMut
data_RAAM <- rbind(RAAM_raw_1, RAAM_raw_2)
library(ggplot2)
library(dplyr)
library(readr)
library(tidyverse)
library(broom)
data_RAAM_raw <- read_csv("Data_AkrongAndMcGahan.csv")
colnames(data_RAAM_raw)[2] <- "B1"
colnames(data_RAAM_raw)[3] <- "B2"
colnames(data_RAAM_raw)[4] <- "B1"
colnames(data_RAAM_raw)[5] <- "B2"
#have to split for generlization later (corresponed WT)
RAAM_1 <- data_RAAM_raw %>%
select(c(1, 2, 3, 6, 7, 8)) %>%
filter(library != 0, B1 != 0 | B2 != 0) %>%
mutate_all(~ ifelse(. == 0, 0.1, .))
#GENERALIZE
#formula: dMut = (Mut B1/ WT B1) / (Mut lib / WT lib)
RAAM_1$B1dMut <- (RAAM_1$B1/ RAAM_1$B1[1])  / (RAAM_1$library/ RAAM_1$library[1])
RAAM_1$B2dMut <- (RAAM_1$B2/ RAAM_1$B2[1])  / (RAAM_1$library/ RAAM_1$library[1])
RAAM_1$changeB2_B1 <- RAAM_1$B2dMut - RAAM_1$B1dMut
RAAM_2 <- data_RAAM_raw %>%
select(c(1, 4, 5, 6, 7, 8)) %>%
filter(library != 0, B1 != 0 | B2 != 0) %>%
mutate_all(~ ifelse(. == 0, 0.1, .))
#GENERALIZE
#formula: dMut = (Mut B1/ WT B1) / (Mut lib / WT lib)
RAAM_2$B1dMut <- (RAAM_2$B1/ RAAM_2$B1[1])  / (RAAM_2$library/ RAAM_2$library[1])
RAAM_2$B2dMut <- (RAAM_2$B2/ RAAM_2$B2[1])  / (RAAM_2$library/ RAAM_2$library[1])
RAAM_2$changeB2_B1 <- RAAM_2$B2dMut - RAAM_2$B1dMut
data_RAAM <- rbind(RAAM_1, RAAM_2)
#Manipulate Akrong's data
for_colab_RA <- read_csv("https://raw.githubusercontent.com/tranJen/GLM_Rabi/main/for_colab_RA.csv")
data_RAAM_raw <- read_csv("Data_AkrongAndMcGahan.csv")
colnames(data_RAAM_raw)[2] <- "B1"
colnames(data_RAAM_raw)[3] <- "B2"
colnames(data_RAAM_raw)[4] <- "B1"
colnames(data_RAAM_raw)[5] <- "B2"
#have to split for generlization later (corresponed WT)
RAAM_1 <- data_RAAM_raw %>%
select(c(1, 2, 3, 6, 7, 8)) %>%
filter(library != 0, B1 != 0 | B2 != 0) %>%
mutate_all(~ ifelse(. == 0, 0.1, .))
#GENERALIZE
#formula: dMut = (Mut B1/ WT B1) / (Mut lib / WT lib)
RAAM_1$B1dMut <- (RAAM_1$B1/ RAAM_1$B1[1])  / (RAAM_1$library/ RAAM_1$library[1])
RAAM_1$B2dMut <- (RAAM_1$B2/ RAAM_1$B2[1])  / (RAAM_1$library/ RAAM_1$library[1])
RAAM_1$changeB2_B1 <- RAAM_1$B2dMut - RAAM_1$B1dMut
RAAM_2 <- data_RAAM_raw %>%
select(c(1, 4, 5, 6, 7, 8)) %>%
filter(library != 0, B1 != 0 | B2 != 0) %>%
mutate_all(~ ifelse(. == 0, 0.1, .))
#GENERALIZE
#formula: dMut = (Mut B1/ WT B1) / (Mut lib / WT lib)
RAAM_2$B1dMut <- (RAAM_2$B1/ RAAM_2$B1[1])  / (RAAM_2$library/ RAAM_2$library[1])
RAAM_2$B2dMut <- (RAAM_2$B2/ RAAM_2$B2[1])  / (RAAM_2$library/ RAAM_2$library[1])
RAAM_2$changeB2_B1 <- RAAM_2$B2dMut - RAAM_2$B1dMut
data_RAAM <- rbind(RAAM_1, RAAM_2)
View(data_RAAM_raw)
data_RAAM_raw <- read_csv("Data_AkrongAndMcGahan.csv")
#have to split for generalization later (correspond WT)
RAAM_1 <- data_RAAM_raw %>%
select(c(1, 2, 3, 6, 7, 8)) %>%
filter(library != 0, B1_1 != 0 | B2_1 != 0) %>%
mutate_all(~ ifelse(. == 0, 0.1, .))
#GENERALIZE
#formula: dMut = (Mut B1/ WT B1) / (Mut lib / WT lib)
RAAM_1$B1dMut <- (RAAM_1$B1_1/ RAAM_1$B1_1[1])  / (RAAM_1$library/ RAAM_1$library[1])
RAAM_1$B2dMut <- (RAAM_1$B2/ RAAM_1$B2[1])  / (RAAM_1$library/ RAAM_1$library[1])
data_RAAM_raw <- read_csv("Data_AkrongAndMcGahan.csv")
#have to split for generalization later (correspond WT)
RAAM_1 <- data_RAAM_raw %>%
select(c(1, 2, 3, 6, 7, 8)) %>%
filter(library != 0, B1_1 != 0 | B2_1 != 0) %>%
mutate_all(~ ifelse(. == 0, 0.1, .))
#GENERALIZE
#formula: dMut = (Mut B1/ WT B1) / (Mut lib / WT lib)
RAAM_1$B1dMut <- (RAAM_1$B1_1/ RAAM_1$B1_1[1])  / (RAAM_1$library/ RAAM_1$library[1])
RAAM_1$B2dMut <- (RAAM_1$B2_1/ RAAM_1$B2_1[1])  / (RAAM_1$library/ RAAM_1$library[1])
RAAM_1$changeB2_B1 <- RAAM_1$B2dMut - RAAM_1$B1dMut
data_RAAM_raw <- read_csv("Data_AkrongAndMcGahan.csv")
#have to split for generalization later (correspond WT)
RAAM_1 <- data_RAAM_raw %>%
select(c(1, 2, 3, 6, 7, 8)) %>%
filter(library != 0, B1_1 != 0 | B2_1 != 0) %>%
mutate_all(~ ifelse(. == 0, 0.1, .))
#GENERALIZE
#formula: dMut = (Mut B1/ WT B1) / (Mut lib / WT lib)
RAAM_1$B1dMut <- (RAAM_1$B1_1/ RAAM_1$B1_1[1])  / (RAAM_1$library/ RAAM_1$library[1])
RAAM_1$B2dMut <- (RAAM_1$B2_1/ RAAM_1$B2_1[1])  / (RAAM_1$library/ RAAM_1$library[1])
RAAM_1$changeB2_B1 <- RAAM_1$B2dMut - RAAM_1$B1dMut
RAAM_2 <- data_RAAM_raw %>%
select(c(1, 4, 5, 6, 7, 8)) %>%
filter(library != 0, B1_2 != 0 | B2_2 != 0) %>%
mutate_all(~ ifelse(. == 0, 0.1, .))
#GENERALIZE
#formula: dMut = (Mut B1/ WT B1) / (Mut lib / WT lib)
RAAM_2$B1dMut <- (RAAM_2$B1_2/ RAAM_2$B1_2[1])  / (RAAM_2$library/ RAAM_2$library[1])
RAAM_2$B2dMut <- (RAAM_2$B2_2/ RAAM_2$B2_2[1])  / (RAAM_2$library/ RAAM_2$library[1])
RAAM_2$changeB2_B1 <- RAAM_2$B2dMut - RAAM_2$B1dMut
data_RAAM <- rbind(RAAM_1, RAAM_1)
data_RAAM_raw <- read_csv("Data_AkrongAndMcGahan.csv")
RAAM <- data_RAAM_raw %>%
select(c(1, 2, 3, 6, 7, 8)) %>%
filter(library != 0, B1_1 != 0 | B2_1 != 0, B1_2 != 0 | B2_2 != 0 ) %>%
mutate_all(~ ifelse(. == 0, 0.1, .))
data_RAAM_raw <- read_csv("Data_AkrongAndMcGahan.csv")
RAAM <- data_RAAM_raw %>%
filter(library != 0, B1_1 != 0 | B2_1 != 0, B1_2 != 0 | B2_2 != 0 ) %>%
mutate_all(~ ifelse(. == 0, 0.1, .))
View(RAAM)
data_RAAM_raw <- read_csv("Data_AkrongAndMcGahan.csv")
RAAM <- data_RAAM_raw %>%
filter(library != 0, B1_1 != 0 | B2_1 != 0 ) %>%
mutate_all(~ ifelse(. == 0, 0.1, .))
data_RAAM_raw <- read_csv("Data_AkrongAndMcGahan.csv")
#have to split for generalization later (correspond WT)
RAAM_1 <- data_RAAM_raw %>%
select(c(1, 2, 3, 6, 7, 8)) %>%
filter(library != 0, B1_1 != 0 | B2_1 != 0) %>%
mutate_all(~ ifelse(. == 0, 0.1, .))
#GENERALIZE
#formula: dMut = (Mut B1/ WT B1) / (Mut lib / WT lib)
RAAM_1$B1dMut <- (RAAM_1$B1_1/ RAAM_1$B1_1[1])  / (RAAM_1$library/ RAAM_1$library[1])
RAAM_1$B2dMut <- (RAAM_1$B2_1/ RAAM_1$B2_1[1])  / (RAAM_1$library/ RAAM_1$library[1])
RAAM_1$changeB2_B1 <- RAAM_1$B2dMut - RAAM_1$B1dMut
RAAM_2 <- data_RAAM_raw %>%
select(c(1, 4, 5, 6, 7, 8)) %>%
filter(library != 0, B1_2 != 0 | B2_2 != 0) %>%
mutate_all(~ ifelse(. == 0, 0.1, .))
#GENERALIZE
#formula: dMut = (Mut B1/ WT B1) / (Mut lib / WT lib)
RAAM_2$B1dMut <- (RAAM_2$B1_2/ RAAM_2$B1_2[1])  / (RAAM_2$library/ RAAM_2$library[1])
RAAM_2$B2dMut <- (RAAM_2$B2_2/ RAAM_2$B2_2[1])  / (RAAM_2$library/ RAAM_2$library[1])
RAAM_2$changeB2_B1 <- RAAM_2$B2dMut - RAAM_2$B1dMut
data_RAAM <- rbind(RAAM_1, RAAM_1)
View(RAAM_1)
View(RAAM_2)
data_RAAM_raw <- read_csv("Data_AkrongAndMcGahan.csv")
#have to split for generalization later (correspond WT)
RAAM_1 <- data_RAAM_raw %>%
select(c(1, 2, 3, 6, 7, 8)) %>%
filter(library != 0, B1_1 != 0 | B2_1 != 0) %>%
mutate_all(~ ifelse(. == 0, 0.1, .))
#GENERALIZE
#formula: dMut = (Mut B1/ WT B1) / (Mut lib / WT lib)
RAAM_1$B1_1dMut <- (RAAM_1$B1_1/ RAAM_1$B1_1[1])  / (RAAM_1$library/ RAAM_1$library[1])
RAAM_1$B2_1dMut <- (RAAM_1$B2_1/ RAAM_1$B2_1[1])  / (RAAM_1$library/ RAAM_1$library[1])
RAAM_1$changeB2_B1 <- RAAM_1$B2_1dMut - RAAM_1$B1_1dMut
RAAM_2 <- data_RAAM_raw %>%
select(c(1, 4, 5, 6, 7, 8)) %>%
filter(library != 0, B1_2 != 0 | B2_2 != 0) %>%
mutate_all(~ ifelse(. == 0, 0.1, .))
#GENERALIZE
#formula: dMut = (Mut B1/ WT B1) / (Mut lib / WT lib)
RAAM_2$B1_2dMut <- (RAAM_2$B1_2/ RAAM_2$B1_2[1])  / (RAAM_2$library/ RAAM_2$library[1])
RAAM_2$B2_2dMut <- (RAAM_2$B2_2/ RAAM_2$B2_2[1])  / (RAAM_2$library/ RAAM_2$library[1])
RAAM_2$changeB2_B1 <- RAAM_2$B2_2dMut - RAAM_2$B1_2dMut
data_RAAM <- rbind(RAAM_1['pos','mut','channgeB2_B1'],RAAM_2['pos','mut','channgeB2_B1'] )
data_RAAM <- rbind(
select(RAAM_1, pos, mut, channgeB2_B1),
select(RAAM_2, pos, mut, channgeB2_B1)
)
data_RAAM <- rbind(
select(RAAM_1, 'pos', 'mut', 'channgeB2_B1'),
select(RAAM_2, 'pos', 'mut', 'channgeB2_B1')
)
data_RAAM <- rbind(
select(RAAM_1, 'pos', 'mut', 'changeB2_B1'),
select(RAAM_2, 'pos', 'mut', 'changeB2_B1')
)
data_RAAM<- arrange(data_RAAM, pos)
data_RAAM$pos <- as.character(data_RAAM$pos)
data_RAAM_raw <- read_csv("Data_AkrongAndMcGahan.csv")
#have to split for generalization later (correspond WT)
RAAM_1 <- data_RAAM_raw %>%
select(c(1, 2, 3, 6, 7, 8)) %>%
filter(library != 0, B1_1 != 0 | B2_1 != 0) %>% #remove rows that has library = 0 OR (b1 = 0 AND b2 = 0)
mutate_all(~ ifelse(. == 0, 0.1, .)) #change value=0 to 0.1
#GENERALIZE
#formula: dMut = (Mut B1/ WT B1) / (Mut lib / WT lib)
RAAM_1$B1_1dMut <- (RAAM_1$B1_1/ RAAM_1$B1_1[1])  / (RAAM_1$library/ RAAM_1$library[1])
RAAM_1$B2_1dMut <- (RAAM_1$B2_1/ RAAM_1$B2_1[1])  / (RAAM_1$library/ RAAM_1$library[1])
RAAM_1$changeB2_B1 <- RAAM_1$B2_1dMut - RAAM_1$B1_1dMut
RAAM_2 <- data_RAAM_raw %>%
select(c(1, 4, 5, 6, 7, 8)) %>%
filter(library != 0, B1_2 != 0 | B2_2 != 0) %>%
mutate_all(~ ifelse(. == 0, 0.1, .))
#GENERALIZE
#formula: dMut = (Mut B1/ WT B1) / (Mut lib / WT lib)
RAAM_2$B1_2dMut <- (RAAM_2$B1_2/ RAAM_2$B1_2[1])  / (RAAM_2$library/ RAAM_2$library[1])
RAAM_2$B2_2dMut <- (RAAM_2$B2_2/ RAAM_2$B2_2[1])  / (RAAM_2$library/ RAAM_2$library[1])
RAAM_2$changeB2_B1 <- RAAM_2$B2_2dMut - RAAM_2$B1_2dMut
#binding
data_RAAM <- rbind(
select(RAAM_1, 'pos', 'mut', 'changeB2_B1'),
select(RAAM_2, 'pos', 'mut', 'changeB2_B1')
)
data_RAAM<- arrange(data_RAAM, pos)
data_RAAM$pos <- as.character(data_RAAM$pos)
gauss_model <- glm( changeB2_B1 ~ pos * mut , data = df, family = 'gaussian')
gauss_model <- glm( changeB2_B1 ~ pos * mut , data = data_RAAM, family = 'gaussian')
#options(max.print=10000)    #set limit to print the output
summary(gauss_model)
fea <- names(coef(gauss_model))[44:length(names(coef(gauss_model)))]      #get features' names
#split the features' names (e.g from "pos137:mutA" to "137" and "A")
mut <- list()
pos <- list ()
for (i in fea){
str_split <- strsplit(i, ":")
pos <- append(pos, substr(str_split[[1]][1], 4,6))    # e.g extract 137
mut <- append(mut, substr(str_split[[1]][2], 4,4))    # e.g extract A
}
est <- coef(gauss_model)[-1][43:length(coef(gauss_model)[-1])]          #get estimated contribution
#p <- coef(summary(gauss_model))[-1,4]         #get p-value
p <- tidy(gauss_model)$p.value[44:483]        #to extract all including NA value
#create data frame of pos, mut, estimated contribution, alpha
data_for_plot<- do.call(rbind, Map(data.frame, Pos=pos, Mut=mut, Est = est, p_value =p))
data_for_plot$alpha <- ifelse(data_for_plot$p_value<0.001,'***', ifelse(0.001 <data_for_plot$p_value & data_for_plot$p_value<0.01,'**', ifelse(0.01<data_for_plot$p_value& data_for_plot$p_value<0.05,'*', ifelse(0.05<data_for_plot$p_value& data_for_plot$p_value<0.1,'.', ' '))))
#plot estimated contribution vs features
ggplot(data_for_plot, aes(x = Pos, y = Mut)) +
geom_tile(aes(fill = Est)) +
geom_text(aes(label = alpha), size = 3)+
scale_fill_gradient2(midpoint= 0, na.value = 'white',high = 'darkgoldenrod1 ', low = 'cyan4', mid ='aliceblue')+
theme_classic() +
theme(axis.text.x = element_text(angle = 75, hjust=1), plot.subtitle = element_text(size = 10, color = "red", face = "bold"))+
labs(y = "Mutation Amino Acid", x = "Enzyme Position", fill= 'Estimated
Contribution', subtitle = 'Signif. codes:  0 *** 0.001 ** 0.01 * 0.05 . 0.1   1')
library(ggplot2)
library(dplyr)
library(readr)
library(tidyverse)
library(broom)
data_RAAM_raw <- read_csv("Data_JuliAndEmma.csv")
#have to split for generalization later (correspond WT)
RAAM_1 <- data_RAAM_raw %>%
select(c(1, 2, 3, 6, 7, 8)) %>%
filter(library != 0, B1_1 != 0 | B2_1 != 0) %>% #remove rows that has library = 0 OR (b1 = 0 AND b2 = 0)
mutate_all(~ ifelse(. == 0, 0.1, .)) #change value=0 to 0.1
#GENERALIZE
#formula: dMut = (Mut B1/ WT B1) / (Mut lib / WT lib)
RAAM_1$B1_1dMut <- (RAAM_1$B1_1/ RAAM_1$B1_1[1])  / (RAAM_1$library/ RAAM_1$library[1])
RAAM_1$B2_1dMut <- (RAAM_1$B2_1/ RAAM_1$B2_1[1])  / (RAAM_1$library/ RAAM_1$library[1])
RAAM_1$changeB2_B1 <- RAAM_1$B2_1dMut - RAAM_1$B1_1dMut
RAAM_2 <- data_RAAM_raw %>%
select(c(1, 4, 5, 6, 7, 8)) %>%
filter(library != 0, B1_2 != 0 | B2_2 != 0) %>%
mutate_all(~ ifelse(. == 0, 0.1, .))
#GENERALIZE
#formula: dMut = (Mut B1/ WT B1) / (Mut lib / WT lib)
RAAM_2$B1_2dMut <- (RAAM_2$B1_2/ RAAM_2$B1_2[1])  / (RAAM_2$library/ RAAM_2$library[1])
RAAM_2$B2_2dMut <- (RAAM_2$B2_2/ RAAM_2$B2_2[1])  / (RAAM_2$library/ RAAM_2$library[1])
RAAM_2$changeB2_B1 <- RAAM_2$B2_2dMut - RAAM_2$B1_2dMut
#binding
data_RAAM <- rbind(
select(RAAM_1, 'pos', 'mut', 'changeB2_B1'),
select(RAAM_2, 'pos', 'mut', 'changeB2_B1')
)
data_RAAM<- arrange(data_RAAM, pos)
data_RAAM$pos <- as.character(data_RAAM$pos)
gauss_model <- glm( changeB2_B1 ~ pos * mut , data = data_RAAM, family = 'gaussian')
#options(max.print=10000)    #set limit to print the output
summary(gauss_model)
fea <- names(coef(gauss_model))[44:length(names(coef(gauss_model)))]      #get features' names
#split the features' names (e.g from "pos137:mutA" to "137" and "A")
mut <- list()
pos <- list ()
for (i in fea){
str_split <- strsplit(i, ":")
pos <- append(pos, substr(str_split[[1]][1], 4,6))    # e.g extract 137
mut <- append(mut, substr(str_split[[1]][2], 4,4))    # e.g extract A
}
est <- coef(gauss_model)[-1][43:length(coef(gauss_model)[-1])]          #get estimated contribution
#p <- coef(summary(gauss_model))[-1,4]         #get p-value
p <- tidy(gauss_model)$p.value[44:483]        #to extract all including NA value
fea <- names(coef(gauss_model))[44:length(names(coef(gauss_model)))]      #get features' names
#split the features' names (e.g from "pos137:mutA" to "137" and "A")
mut <- list()
pos <- list ()
for (i in fea){
str_split <- strsplit(i, ":")
pos <- append(pos, substr(str_split[[1]][1], 4,6))    # e.g extract 137
mut <- append(mut, substr(str_split[[1]][2], 4,4))    # e.g extract A
}
est <- coef(gauss_model)[-1][43:length(coef(gauss_model)[-1])]          #get estimated contribution
#p <- coef(summary(gauss_model))[-1,4]         #get p-value
p <- tidy(gauss_model)$p.value[44:483]        #to extract all including NA value
#create data frame of pos, mut, estimated contribution, alpha
data_for_plot<- do.call(rbind, Map(data.frame, Pos=pos, Mut=mut, Est = est, p_value =p))
data_for_plot$alpha <- ifelse(data_for_plot$p_value<0.001,'***', ifelse(0.001 <data_for_plot$p_value & data_for_plot$p_value<0.01,'**', ifelse(0.01<data_for_plot$p_value& data_for_plot$p_value<0.05,'*', ifelse(0.05<data_for_plot$p_value& data_for_plot$p_value<0.1,'.', ' '))))
#plot estimated contribution vs features
ggplot(data_for_plot, aes(x = Pos, y = Mut)) +
geom_tile(aes(fill = Est)) +
geom_text(aes(label = alpha), size = 3)+
scale_fill_gradient2(midpoint= 0, na.value = 'white',high = 'darkgoldenrod1 ', low = 'cyan4', mid ='aliceblue')+
theme_classic() +
theme(axis.text.x = element_text(angle = 75, hjust=1), plot.subtitle = element_text(size = 10, color = "red", face = "bold"))+
labs(y = "Mutation Amino Acid", x = "Enzyme Position", fill= 'Estimated
Contribution', subtitle = 'Signif. codes:  0 *** 0.001 ** 0.01 * 0.05 . 0.1   1')
